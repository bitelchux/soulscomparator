var e={get:function(e){var t=document.cookie.match(new RegExp(e+"=[a-zA-Z0-9.()=|%/_]+($|;)","g"));if(!t||!t[0])return null;else return unescape(t[0].substring(e.length+1,t[0].length).replace(";",""))||null},set:function(e,t,a,s){var r=[e+"="+escape(t),"path="+(!a||a==""?"/":a),"domain="+(!s||s==""?window.location.host:s)];return document.cookie=r.join("; ")}};var t={DkS1:"darksouls1",DkS2:"darksouls2"};var a=300;String.prototype.capitalize=function(){return this,this.charAt(0).toUpperCase()+this.slice(1)};var s=new Firebase("https://darksoulscomparator.firebaseIO.com");var r={armors:[],shields:[],weapons:[],pieces:{head:[],chest:[],hands:[],legs:[]}};var i=null;var n={1:null,2:null};var l=e.get("game")||t.DkS1;var o=null;u();function u(){s.child(l+"/indexes").on("value",function(e){data=e.val();r.weapons=data.weapons[B(data.weapons)];r.armors=data.armors[B(data.armors)];r.shields=data.shields[B(data.shields)];r.pieces=data.pieces[B(data.pieces)];console.log("indexes",r);h();$("#type").removeAttr("disabled");$("#type").selectpicker("refresh");$("select.basic-comparator").on("change",function(e){var t=unescape($(this).val());var a=$(this).attr("data-item");var s=$("#type").val();var i=r[s].filter(function(e){return B(e)===t})[0][t];m(a,i)});$("select.detailed-comparator").on("change",function(e){var t=unescape($(this).val());var a=$(this).attr("data-item");var s=$(this).attr("data-piece");var i=0;if(t!=="naked"&&t){i=r.pieces[s].filter(function(e){return B(e)===t})[0][t]}f(a,s,i)})})}function c(){$("#comparison").html("");$("#by-widgets").hide();$("#by").selectpicker("val",null);$("#detailed-widgets").hide();$("#basic-widgets").hide();$(".basic-level").selectpicker("val",null);P();D()}$(document).ready(function(){P();$("#game").val(l);$("#game").on("change",function(t){l=$(this).val();c();$("#type").attr("disabled","");$("#type").selectpicker("val",null);e.set("game",l);u()});$("#type").on("change",function(e){i=$(this).val();c();if(i==="armors"){p()}else{d()}});$(".set-comparator").on("change",function(e){var t=$(this).val();var a=$(this).attr("data-item");if(t==="custom"){R(a)}else{t=unescape(t);var s=r.armors.filter(function(e){return B(e)===t})[0][t];P(a);g(a,s)}var i=unescape($('.set-comparator[data-item="1"]').selectpicker("val"));var n=unescape($('.set-comparator[data-item="2"]').selectpicker("val"));if(i==="custom"||n==="custom"){$("#detailed-widgets").show()}else{$("#detailed-widgets").hide()}});$("button#compare").on("click",function(e){w();var a=unescape($(this).val());if(i==="armors"){var s=b().then(function(e){if(l===t.DkS1){o=new C({el:"#comparison"});o.render(e[0],e[1])}else if(l===t.DkS2){o=new E({el:"#comparison"});o.render(e[0],e[1])}x(e[0],e[1],i).then(function(e){o.renderSetsEvolution(e[0],e[1])});S()}).catch(function(e){alert(e);S()})}else{var s=v().then(function(e){var a=i==="shields";if(l===t.DkS1){o=new W({el:"#comparison"});o.render(e[0],e[1],a)}else if(l===t.DkS2){o=new N({el:"#comparison"});o.render(e[0],e[1],a)}V(e[0].name,e[1].name,i).then(function(t){if(i==="weapons"){o.renderWeaponsEvolution(t[0],t[1])}else{o.renderShieldsEvolution(t[0],t[1]);o.renderReductionsChart(e[0],e[1])}});S()}).catch(function(e){alert(e);S()})}})});Handlebars.registerHelper("toTitleCase",function(e){return e.split("_").map(function(e){return e[0].toUpperCase()+e.slice(1,e.length)}).join(" ")});function d(){var e="";r[i].map(function(e){return B(e)}).sort().forEach(function(t){e+='<option value="'+escape(t)+'">'+t+"</option>"});$("select.basic-comparator").html(e);$("select.basic-comparator").selectpicker("refresh");$("#basic-widgets").show()}function p(){var e='<option value="custom">Custom</option>';e+='<optgroup label="Sets">';r[i].map(function(e){return B(e)}).sort().forEach(function(t){e+='<option value="'+escape(t)+'">'+t+"</option>"});e+="</optgroup>";$("select.set-comparator").html(e);$("select.set-comparator").selectpicker("refresh");$("#by-widgets").show()}function h(){Object.keys(r.pieces).forEach(function(e){var t='<option value="naked">Naked</option>';t+='<option data-divider="true"></option>';var a=r.pieces[e].map(function(e){return B(e)}).sort();a.forEach(function(e){t+='<option value="'+escape(e)+'">'+e+"</option>"});var s=$('select.detailed-comparator[data-piece="'+e+'"]');s.html(t);s.selectpicker("refresh")})}function m(e,t){var a='<option value="0" selected>0</option>';for(var s=1;s<=t;s++){a+='<option value="'+s+'">+'+s+"</option>"}var r=$('select.basic-level[data-level="'+e+'"]');r.html(a);r.selectpicker("refresh")}function f(e,t,a){var s='<option value="0" selected>0</option>';for(var r=1;r<=a;r++){s+='<option value="'+r+'">+'+r+"</option>"}var i=$('select.detailed-level[data-level="'+e+'"][data-piece="'+t+'"]');i.html(s);i.selectpicker("refresh")}function g(e,t){var a='<option value="0" selected>0</option>';for(var s=1;s<=t;s++){a+='<option value="'+s+'">+'+s+"</option>"}var r=$('select.set-level[data-level="'+e+'"]');r.html(a);r.selectpicker("refresh")}function v(){var e=unescape($('.basic-comparator[data-item="1"]').selectpicker("val"));var t=unescape($('.basic-comparator[data-item="2"]').selectpicker("val"));var a=unescape($('.basic-level[data-level="1"]').selectpicker("val"));var r=unescape($('.basic-level[data-level="2"]').selectpicker("val"));return new Promise(function(n,o){var u,c;var d=a!=="0"?e+" +"+a:e;var p=r!=="0"?t+" +"+r:t;s.child(l+"/"+i).orderByChild("name").equalTo(d).once("value",function(e){var t=e.val();u=t[Object.keys(t)[0]];if(u&&c)n([u,c])});s.child(l+"/"+i).orderByChild("name").equalTo(p).once("value",function(e){var t=e.val();c=t[Object.keys(t)[0]];if(u&&c)n([u,c])})})}function b(){var e=unescape($('.set-comparator[data-item="1"]').selectpicker("val"));var t=unescape($('.set-comparator[data-item="2"]').selectpicker("val"));return new Promise(function(a,s){var r,i;if(e==="custom"){var n=k(A(1))}else{var l=$('select.set-level[data-level="1"]').selectpicker("val");var o=l!=="0"?e+" +"+l:e;var n=y(o)}n.then(function(e){r=e;if(r&&i)a([r,i])});if(t==="custom"){var u=k(A(2))}else{var l=$('select.set-level[data-level="2"]').selectpicker("val");var c=l!=="0"?t+" +"+l:t;var u=y(c)}u.then(function(e){i=e;if(r&&i)a([r,i])})})}function y(e){console.log("looking for set",e);return new Promise(function(t,a){s.child(l+"/armors").orderByChild("set").equalTo(e).once("value",function(e){var a=e.val();console.log("data",a);var s={pieces:[]};Object.keys(a).forEach(function(e){s.pieces.push(a[e])});t(s)})})}function k(e){return new Promise(function(t,a){var i={pieces:[]};Object.keys(r.pieces).forEach(function(a){if(e[a]){var r=unescape(e[a]);var n=new Promise(function(e,t){if(r!=="naked"){s.child(l+"/armors").orderByChild("name").equalTo(r).once("value",function(t){var s=t.val();var r=null;if(s===null){r=new I("Error fetching "+a.capitalize(),a)}else{r=s[Object.keys(s)[0]]}e(r)})}else{var i=new I("Naked "+a.capitalize(),a);e(i)}});n.then(function(a){i.pieces.push(a);if(i.pieces.length===Object.keys(e).length){t(i)}})}})})}function A(e){var t={};Object.keys(r.pieces).forEach(function(a){var s=$('select.detailed-comparator[data-item="'+e+'"][data-piece="'+a+'"]').selectpicker("val");var r=$('select.detailed-level[data-level="'+e+'"][data-piece="'+a+'"]').selectpicker("val");t[a]=r!=="0"?s+" +"+r:s});return t}function V(e,t,a){var r=e.split("+")[0].trim();var i=t.split("+")[0].trim();return new Promise(function(e,t){var n,o;s.child(l+"/"+a).orderByChild("name").startAt(r).endAt(r+" +999").once("value",function(t){var a=t.val();n={name:r,data:Object.keys(a).map(function(e){return a[e]})};if(n&&o)e([n,o])});s.child(l+"/"+a).orderByChild("name").startAt(i).endAt(i+" +999").once("value",function(t){var a=t.val();o={name:i,data:Object.keys(a).map(function(e){return a[e]})};if(n&&o)e([n,o])})})}function x(e,t){var a,r;return new Promise(function(i,n){var o=new Promise(function(t,a){var r=[];e.pieces.forEach(function(e){var a=e.name.split("+")[0].trim();s.child(l+"/armors").orderByChild("name").startAt(a).endAt(a+" +999").once("value",function(e){var s=e.val();r.push({name:a,data:Object.keys(s).map(function(e){return s[e]})});if(r.length===4)t(r)})})});var u=new Promise(function(e,a){var r=[];t.pieces.forEach(function(t){var a=t.name.split("+")[0].trim();s.child(l+"/armors").orderByChild("name").startAt(a).endAt(a+" +999").once("value",function(t){var s=t.val();r.push({name:a,data:Object.keys(s).map(function(e){return s[e]})});if(r.length===4)e(r)})})});o.then(function(e){a=e;if(a&&r)i([a,r])});u.then(function(e){r=e;if(a&&r)i([a,r])})})}function S(){$("button#compare").removeAttr("disabled")}function w(e){$("button#compare").attr("disabled","")}function R(e){var t=e?'[data-item="'+e+'"]':"";var a=$("select.detailed-comparator"+t);a.removeAttr("disabled");a.selectpicker("refresh");var s=e?'[data-level="'+e+'"]':"";a=$("select.detailed-level"+s);a.removeAttr("disabled");a.selectpicker("refresh");var r=$("select.set-level"+s);r.attr("disabled","");r.selectpicker("refresh")}function P(e){var t=e?'[data-item="'+e+'"]':"";var a=$("select.detailed-comparator"+t);a.attr("disabled","");a.selectpicker("refresh");var s=e?'[data-level="'+e+'"]':"";a=$("select.detailed-level"+s);a.attr("disabled","");a.selectpicker("refresh");var r=$("select.set-level"+s);r.removeAttr("disabled");r.selectpicker("refresh")}function D(){$("select.detailed-comparator").selectpicker("deselectAll");$("select.detailed-level").selectpicker("deselectAll")}function B(e){return Object.keys(e)[0]}var F=function(){var e=Handlebars.compile($("#attribute-template").html());var t=Handlebars.compile($("#image-template").html());var s=Handlebars.compile($("#chart-box-template").html());var r=["-","â€“","S","A","B","C","D","E"];var i=function(e,t){if(e!==t){if(e==="S"){return-1}else if(t==="S"){return 1}else if(e==="-"&&t!=="-"){return 1}else if(e!=="-"&&t==="-"){return-1}else{if(e>t)return 1;if(e<t)return-1}}else{return 0}};return{renderAttribute:function(t,a,s,n,l){l=l||{};var o=color2="",u="=";if(l.isNegative){goodColor="red";badColor="blue"}else{goodColor="blue";badColor="red"}if(l.invertSymbols){biggerThanSymbol="<";lesserThanSymbol=">"}else{biggerThanSymbol=">";lesserThanSymbol="<"}if(!l.isString){s=s==="â€“"||s==="-"||s===""?0:parseFloat(s);n=n==="â€“"||n==="-"||n===""?0:parseFloat(n)}if(i(s,n)>0){o=goodColor;color2=badColor;u=biggerThanSymbol}else if(i(s,n)<0){o=badColor;color2=goodColor;u=lesserThanSymbol}if(!l.isInteger&&!l.isPercentage){s=r.indexOf(s)>=0?s:s.toFixed(1);n=r.indexOf(n)>=0?n:n.toFixed(1)}if(l.isPercentage){s=s+"%";n=n+"%"}tooltip=l.tooltip||a;var c={key:a,icon:{icon:t,caption:a},tooltip:tooltip,color1:o,color2:color2,value1:s,value2:n,symbol:u};if(l.notIcon)delete c.icon;return e(c)},renderImage:function(e,a,s){var r=e[a];var i=e[s];return t({name:unescape(e.name),source:e.wiki_image,title1:a,title2:s,type1:r,type2:i})},renderChartBox:function(e,t){return s({id:e,layout:t})},drawWeaponEvolution:function(e,t,s,r){var i=[];for(var n=0;n<Math.max(t.length,r.length);n++){i.push("+"+n)}$("#weapons-evolution").highcharts({chart:{height:a},title:{text:"Weapons damage evolution"},credits:{enabled:false},yAxis:{title:{text:"Total Damage"}},xAxis:{categories:i},series:[{data:t,name:e},{data:r,name:s}]})},drawShieldEvolution:function(e,t,s,r){var i=[];for(var n=0;n<Math.max(t.length,r.length);n++){i.push("+"+n)}$("#shields-evolution").highcharts({chart:{height:a},title:{text:"Shields stability evolution"},credits:{enabled:false},yAxis:{title:{text:"Stability"}},xAxis:{categories:i},series:[{data:t,name:e},{data:r,name:s}]})},drawShieldsReductions:function(e,t,s,r,i){$("#shields-reduction").highcharts({chart:{polar:true,type:"line",height:a},title:{text:"Shields Reduction"},credits:{enabled:false},xAxis:{categories:e,lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0},legend:{align:"center",verticalAlign:"bottom",layout:"vertical"},series:[{name:t,data:s,pointPlacement:"on"},{name:r,data:i,pointPlacement:"on"}]})},drawArmorEvolutions:function(e){var t=[];for(var s=0;s<Math.max(e[0].resistances.length,e[1].resistances.length);s++){t.push("+"+s)}$("#sets-defense-evolution").highcharts({chart:{height:a},title:{text:"Defense evolution by set"},credits:{enabled:false},yAxis:{title:{text:"Total defense (physical + elemental)"}},xAxis:{categories:t},series:[{data:e[0].defenses,name:e[0].name},{data:e[1].defenses,name:e[1].name}]});$("#sets-resistance-evolution").highcharts({chart:{height:a},title:{text:"Resistance evolution by set"},credits:{enabled:false},yAxis:{title:{text:"Total resistance (all resistances)"}},xAxis:{categories:t},series:[{data:e[0].resistances,name:e[0].name},{data:e[1].resistances,name:e[1].name}]})},drawArmorDefenses:function(e,t,s,r,i){$("#sets-defense").highcharts({chart:{polar:true,type:"line",height:a},credits:{enabled:false},title:{text:"Defenses by set"},xAxis:{categories:e,lineWidth:0},yAxis:{gridLineInterpolation:"polygon",lineWidth:0,min:0},legend:{align:"center",verticalAlign:"bottom",layout:"vertical"},series:[{name:t,data:s,pointPlacement:"on"},{name:r,data:i,pointPlacement:"on"}]})},unescape:function(e){e=unescape(e);return e},parseValue:function(e){var t=parseFloat(e);return isNaN(t)?0:t}}}();var C=Backbone.View.extend({initialize:function(){this.isArmor=true;this.contentTemplate=Handlebars.compile($("#content-template").html());this.statsBoxTemplate=Handlebars.compile($("#stats-box-template").html());this.chartBoxTemplate=Handlebars.compile($("#chart-box-template").html())},calculateSetStats:function(e){var t=new T;for(var a=0;a<e.pieces.length;a++){var s=e.pieces[a];t.elemental_defense.fire+=parseFloat(s.elemental_defense.fire);t.elemental_defense.lightning+=parseFloat(s.elemental_defense.lightning);t.elemental_defense.magic+=parseFloat(s.elemental_defense.magic);t.physical_defense.regular+=parseFloat(s.physical_defense.regular);t.physical_defense.strike+=parseFloat(s.physical_defense.strike);t.physical_defense.slash+=parseFloat(s.physical_defense.slash);t.physical_defense.thrust+=parseFloat(s.physical_defense.thrust);t.resistances.bleed+=parseFloat(s.resistances.bleed);t.resistances.poison+=parseFloat(s.resistances.poison);t.resistances.curse+=parseFloat(s.resistances.curse);t.weight+=parseFloat(s.weight);t.poise+=parseFloat(s.poise);t.durability+=parseInt(s.durability);if(t.name===""){t.name=s.set}else if(s.set!==t.name){t.name="Custom Set"}t.type=s.type}return t},calculatePhysicalWeightRatio:function(e){var t;t=F.parseValue(e.physical_defense.regular);t+=F.parseValue(e.physical_defense.strike);t+=F.parseValue(e.physical_defense.slash);t+=F.parseValue(e.physical_defense.thrust);return t/4/F.parseValue(e.weight)},calculateElementalWeightRatio:function(e){var t;t=F.parseValue(e.elemental_defense.fire);t+=F.parseValue(e.elemental_defense.magic);t+=F.parseValue(e.elemental_defense.lightning);return t/3/F.parseValue(e.weight)},calculatePoiseWeightRatio:function(e){return F.parseValue(e.poise)/F.parseValue(e.weight)},renderSets:function(e,t){var a=F.renderImage(e,"type");var s=F.renderImage(t,"type");var r="";r+=this.renderPhysicalDefense(e,t);r+=this.renderElementalDefense(e,t);r+=this.renderResistances(e,t);r+=this.renderOthers(e,t);return this.contentTemplate({body:r,description1:a,description2:s})},renderPiece:function(e){var t="";var a=_.find(this.armor1.pieces,{piece:e})||{};var s=_.find(this.armor2.pieces,{piece:e})||{};var r=F.renderImage(a,"type");var i=F.renderImage(s,"type");var t="";t+=this.renderPhysicalDefense(a,s);t+=this.renderElementalDefense(a,s);t+=this.renderResistances(a,s);t+=this.renderOthers(a,s);return this.contentTemplate({body:t,description1:r,description2:i})},renderPhysicalDefense:function(e,t){var a="",s=e.physical_defense||{},r=t.physical_defense||{},i=this.calculatePhysicalWeightRatio(e),n=this.calculatePhysicalWeightRatio(t);a+=F.renderAttribute("darksouls1/icon_regular_defense","Regular",s.regular,r.regular);a+=F.renderAttribute("darksouls1/icon_strike_defense","Strike",s.strike,r.strike);a+=F.renderAttribute("darksouls1/icon_slash_defense","Slash",s.slash,r.slash);a+=F.renderAttribute("darksouls1/icon_thrust_defense","Thrust",s.thrust,r.thrust);a+=F.renderAttribute("darksouls1/icon_regular_defense","Def/Wei",i.toFixed(2),n.toFixed(2),{tooltip:"Physical Defense/Weight"});return this.statsBoxTemplate({title:"Physical Defense",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderElementalDefense:function(e,t){var a="",s=e.elemental_defense||{},r=t.elemental_defense||{},i=this.calculateElementalWeightRatio(e),n=this.calculateElementalWeightRatio(t);a+=F.renderAttribute("darksouls1/icon_fire_defense","Fire",s.fire,r.fire);a+=F.renderAttribute("darksouls1/icon_magic_defense","Magic",s.magic,r.magic);a+=F.renderAttribute("darksouls1/icon_lightning_defense","Lightning",s.lightning,r.lightning);a+=F.renderAttribute("darksouls1/icon_fire_defense","Ele/Wei",i.toFixed(2),n.toFixed(2),{tooltip:"Elemental Defense/Weight"});return this.statsBoxTemplate({title:"Elemental Defense",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderResistances:function(e,t){var a="",s=e.resistances||{},r=t.resistances||{};a+=F.renderAttribute("darksouls1/icon_bleed","Bleed",s.bleed,r.bleed);a+=F.renderAttribute("darksouls1/icon_poison","Poison",s.poison,r.poison);a+=F.renderAttribute("darksouls1/icon_curse","Curse",s.curse,r.curse);return this.statsBoxTemplate({title:"Resistances",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderOthers:function(e,t){var a=this.calculatePoiseWeightRatio(e),s=this.calculatePoiseWeightRatio(t),r="";r+=F.renderAttribute("darksouls1/icon_poise","Poise",e.poise,t.poise);r+=F.renderAttribute("darksouls1/icon_weight","Weight",e.weight,t.weight,{isNegative:true});r+=F.renderAttribute("darksouls1/icon_durability","Durability",e.durability,t.durability,{isInteger:true});r+=F.renderAttribute("darksouls1/icon_poise","Poi/Wei",a.toFixed(2),s.toFixed(2),{tooltip:"Poise/Weight"});return this.statsBoxTemplate({title:"Others",name1:e.name,name2:t.name,stats:r,isArmor:this.isArmor})},render:function(e,t){this.armor1=e;this.armor2=t;this.set1=this.calculateSetStats(this.armor1);this.set2=this.calculateSetStats(this.armor2);var a=this.renderSets(this.set1,this.set2);a+=F.renderChartBox("sets-defense-evolution","col-sm-12 col-md-6 col-lg-4");a+=F.renderChartBox("sets-resistance-evolution","col-sm-12 col-md-6 col-lg-4");a+=F.renderChartBox("sets-defense","col-sm-12 col-md-6 col-lg-4");a+=this.renderPiece("Head");a+=this.renderPiece("Chest");a+=this.renderPiece("Hands");a+=this.renderPiece("Legs");this.$el.html(a);this.renderDefensesChart(this.set1,this.set2)}});var T=function(e,t){this.elemental_defense={fire:0,lightning:0,magic:0};this.physical_defense={regular:0,strike:0,slash:0,thrust:0};this.resistances={bleed:0,poison:0,curse:0};this.weight=0;this.poise=0;this.durability=0;this.name=e?e:"";this.type="N/A";if(t){this.piece=t.capitalize()}};T.constructor.prototype=T;C.prototype.renderSetsEvolution=function(e,t){var a=[{name:null,defenses:new Array(e[0].data.length),resistances:new Array(e[0].data.length)},{name:null,defenses:new Array(t[0].data.length),resistances:new Array(t[0].data.length)}];e.forEach(function(e){e.data.forEach(function(e){var t=0,s=0;var r=e.set.split("+")[0].trim();if(a[0].name&&a[0].name!==r&&a[0].name!=="Custom Set"){a[0].name="Custom Set"}else if(!a[0].name){a[0].name=r}t+=F.parseValue(e.physical_defense.regular);t+=F.parseValue(e.physical_defense.slash);t+=F.parseValue(e.physical_defense.strike);t+=F.parseValue(e.physical_defense.thrust);t+=F.parseValue(e.elemental_defense.fire);t+=F.parseValue(e.elemental_defense.magic);t+=F.parseValue(e.elemental_defense.lightning);s+=F.parseValue(e.resistances.bleed);s+=F.parseValue(e.resistances.curse);s+=F.parseValue(e.resistances.poison);if(!a[0].defenses[e.level])a[0].defenses[e.level]=0;if(!a[0].resistances[e.level])a[0].resistances[e.level]=0;a[0].defenses[e.level]+=t;a[0].resistances[e.level]+=s})});t.forEach(function(e){e.data.forEach(function(e){var t=0,s=0;var r=e.set.split("+")[0].trim();if(a[1].name&&a[1].name!==r&&a[1].name!=="Custom Set"){a[1].name="Custom Set"}else if(!a[1].name){a[1].name=r}t+=F.parseValue(e.physical_defense.regular);t+=F.parseValue(e.physical_defense.slash);t+=F.parseValue(e.physical_defense.strike);t+=F.parseValue(e.physical_defense.thrust);t+=F.parseValue(e.elemental_defense.fire);t+=F.parseValue(e.elemental_defense.magic);t+=F.parseValue(e.elemental_defense.lightning);s+=F.parseValue(e.resistances.bleed);s+=F.parseValue(e.resistances.curse);s+=F.parseValue(e.resistances.poison);if(!a[1].defenses[e.level])a[1].defenses[e.level]=0;if(!a[1].resistances[e.level])a[1].resistances[e.level]=0;a[1].defenses[e.level]+=t;a[1].resistances[e.level]+=s})});F.drawArmorEvolutions(a)};C.prototype.renderDefensesChart=function(e,t){var a=["Regular Def","Slash Def","Strike Def","Thrust Def","Fire Def","Magic Red","Lightning Red","Bleed Res","Poison Res","Curse Res","Poise","Weight"];var s=[F.parseValue(e.physical_defense.regular),F.parseValue(e.physical_defense.slash),F.parseValue(e.physical_defense.strike),F.parseValue(e.physical_defense.thrust),F.parseValue(e.elemental_defense.fire),F.parseValue(e.elemental_defense.magic),F.parseValue(e.elemental_defense.lightning),F.parseValue(e.resistances.bleed),F.parseValue(e.resistances.poison),F.parseValue(e.resistances.curse),F.parseValue(e.poise),F.parseValue(e.weight)];var r=[F.parseValue(t.physical_defense.regular),F.parseValue(t.physical_defense.slash),F.parseValue(t.physical_defense.strike),F.parseValue(t.physical_defense.thrust),F.parseValue(t.elemental_defense.fire),F.parseValue(t.elemental_defense.magic),F.parseValue(t.elemental_defense.lightning),F.parseValue(t.resistances.bleed),F.parseValue(t.resistances.poison),F.parseValue(t.resistances.curse),F.parseValue(t.poise),F.parseValue(t.weight)];F.drawArmorDefenses(a,e.name,s,t.name,r)};var W=Backbone.View.extend({initialize:function(){this.isArmor=false;this.contentTemplate=Handlebars.compile($("#content-template").html());this.statsBoxTemplate=Handlebars.compile($("#stats-box-template").html())},calculateDamageWeightRatio:function(e){var t;t=F.parseValue(e.stats.physical_damage);t+=F.parseValue(e.stats.fire_damage);t+=F.parseValue(e.stats.magic_damage);t+=F.parseValue(e.stats.lightning_damage);return t/4/F.parseValue(e.weight)},calculateStabilityWeightRation:function(e){return F.parseValue(e.stats.stability)/F.parseValue(e.weight)},renderDamageStats:function(e,t){var a="",s=e.stats,r=t.stats;a+=F.renderAttribute("darksouls1/icon_physical_damage","Regular",s.physical_damage,r.physical_damage);a+=F.renderAttribute("darksouls1/icon_magic_damage","Magic",s.magic_damage,r.magic_damage);a+=F.renderAttribute("darksouls1/icon_fire_damage","Fire",s.fire_damage,r.fire_damage);a+=F.renderAttribute("darksouls1/icon_lightning_damage","Lightning",s.lightning_damage,r.lightning_damage);a+=F.renderAttribute("darksouls1/icon_critical","Critical",s.critical,r.critical);return this.statsBoxTemplate({title:"Damage",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderReductionStats:function(e,t){var a="",s=e.stats,r=t.stats;a+=F.renderAttribute("darksouls1/icon_physical_reduction","Physical",s.physical_reduction,r.physical_reduction);a+=F.renderAttribute("darksouls1/icon_magic_reduction","Magic",s.magic_reduction,r.magic_reduction);a+=F.renderAttribute("darksouls1/icon_fire_reduction","Fire",s.fire_reduction,r.fire_reduction);a+=F.renderAttribute("darksouls1/icon_lightning_reduction","Lightning",s.lightning_reduction,r.lightning_reduction);a+=F.renderAttribute("darksouls1/icon_stability","Stability",s.stability,r.stability);return this.statsBoxTemplate({title:"Reduction",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderParamBonus:function(e,t){var a="",s=e.param_bonus,r=t.param_bonus;a+=F.renderAttribute("darksouls1/icon_strength","Strength",s.strength,r.strength,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls1/icon_dexterity","Dexterity",s.dexterity,r.dexterity,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls1/icon_intelligence","Intelligence",s.intelligence,r.intelligence,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls1/icon_faith","Faith",s.faith,r.faith,{isNegative:true,isString:true,invertSymbols:true});return this.statsBoxTemplate({title:"Param Bonus",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderReqParams:function(e,t){var a="",s=e.req_param,r=t.req_param;a+=F.renderAttribute("darksouls1/icon_strength","Strength",s.strength,r.strength,{isNegative:true,isInteger:true});a+=F.renderAttribute("darksouls1/icon_dexterity","Dexterity",s.dexterity,r.dexterity,{isNegative:true,isInteger:true});a+=F.renderAttribute("darksouls1/icon_intelligence","Intelligence",s.intelligence,r.intelligence,{isNegative:true,isInteger:true});a+=F.renderAttribute("darksouls1/icon_faith","Faith",s.faith,r.faith,{isNegative:true,isInteger:true});return this.statsBoxTemplate({title:"Req Params",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderAuxEffects:function(e,t){var a="",s=e.aux_effect,r=t.aux_effect;a+=F.renderAttribute("darksouls1/icon_bleed","Bleed",s.bleed,r.bleed,{isInteger:true});a+=F.renderAttribute("darksouls1/icon_toxic","Toxic",s.toxic,r.toxic,{isInteger:true});a+=F.renderAttribute("darksouls1/icon_occult","Occult",s.occult,r.occult,{isInteger:true});a+=F.renderAttribute("darksouls1/icon_divine","Divine",s.divine,r.divine,{isInteger:true});return this.statsBoxTemplate({title:"Aux Effects",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderResistances:function(e,t){var a="",s=e.resistances,r=t.resistances;a+=F.renderAttribute("darksouls1/icon_bleed","Bleed",s.bleed,r.bleed,{isPercentage:true});a+=F.renderAttribute("darksouls1/icon_poison","Poison",s.poison,r.poison,{isPercentage:true});a+=F.renderAttribute("darksouls1/icon_toxic","Toxic",s.toxic,r.toxic,{isPercentage:true});a+=F.renderAttribute("darksouls1/icon_curse","Curse",s.curse,r.curse,{isPercentage:true});return this.statsBoxTemplate({title:"Resistances",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderOthers:function(e,t,a){var s="",r=e.stats,i=t.stats;s+=F.renderAttribute("darksouls1/icon_weight","Weight",e.weight,t.weight,{isNegative:true});s+=F.renderAttribute("darksouls1/icon_durability","Durability",e.durability,t.durability,{isInteger:true});if(e.magic_adjust||t.magic_adjust){s+=F.renderAttribute("darksouls1/icon_magic_adjust","Magic Adjust",e.magic_adjust,t.magic_adjust,{isInteger:true})}if(a){var n=this.calculateStabilityWeightRation(e);var l=this.calculateStabilityWeightRation(t);s+=F.renderAttribute("darksouls1/icon_stability","Sta/Wei",n.toFixed(2),l.toFixed(2),{tooltip:"Stability/Weight"})}else{var o=this.calculateDamageWeightRatio(e);var u=this.calculateDamageWeightRatio(t);s+=F.renderAttribute("darksouls1/icon_physical_damage","Dmg/Wei",o.toFixed(2),u.toFixed(2),{tooltip:"Damage/Weight"})}return this.statsBoxTemplate({title:"Others",name1:e.name,name2:t.name,stats:s,isArmor:this.isArmor})},render:function(e,t,a){var s=F.renderImage(e,"attack_type","weapon_type");var r=F.renderImage(t,"attack_type","weapon_type");var i="";i+=this.renderDamageStats(e,t);i+=this.renderReductionStats(e,t);i+=this.renderParamBonus(e,t);i+=this.renderReqParams(e,t);if(a){i+=this.renderResistances(e,t)}else{i+=this.renderAuxEffects(e,t)}i+=this.renderOthers(e,t,a);i+=F.renderChartBox("weapons-evolution","col-sm-12 col-md-12");i+=F.renderChartBox("shields-evolution","col-sm-6 col-md-6");i+=F.renderChartBox("shields-reduction","col-sm-6 col-md-6");content=this.contentTemplate({body:i,description1:s,description2:r});this.$el.html(content)}});W.prototype.renderWeaponsEvolution=function(e,t){var a=e.data.map(function(e){var t=0;t+=F.parseValue(e.stats.physical_damage);t+=F.parseValue(e.stats.magic_damage);t+=F.parseValue(e.stats.fire_damage);t+=F.parseValue(e.stats.lightning_damage);return t});var s=t.data.map(function(e){var t=0;t+=F.parseValue(e.stats.physical_damage);t+=F.parseValue(e.stats.magic_damage);t+=F.parseValue(e.stats.fire_damage);t+=F.parseValue(e.stats.lightning_damage);return t});F.drawWeaponEvolution(e.name,a,t.name,s)};W.prototype.renderShieldsEvolution=function(e,t){var a=e.data.map(function(e){return F.parseValue(e.stats.stability)});var s=t.data.map(function(e){return F.parseValue(e.stats.stability)});F.drawShieldEvolution(e.name,a,t.name,s)};W.prototype.renderReductionsChart=function(e,t){var a=["Physical Red","Fire Red","Magic Red","Lightning Red","Bleed Res","Poison Res","Curse Res","Stability","Weight"];var s=[F.parseValue(e.stats.physical_reduction),F.parseValue(e.stats.magic_reduction),F.parseValue(e.stats.fire_reduction),F.parseValue(e.stats.lightning_reduction),F.parseValue(e.resistances.bleed),F.parseValue(e.resistances.poison),F.parseValue(e.resistances.curse),F.parseValue(e.stats.stability),F.parseValue(e.weight)];var r=[F.parseValue(t.stats.physical_reduction),F.parseValue(t.stats.magic_reduction),F.parseValue(t.stats.fire_reduction),F.parseValue(t.stats.lightning_reduction),F.parseValue(t.resistances.bleed),F.parseValue(t.resistances.poison),F.parseValue(t.resistances.curse),F.parseValue(t.stats.stability),F.parseValue(t.weight)];F.drawShieldsReductions(a,e.name,s,t.name,r)};var E=Backbone.View.extend({initialize:function(){this.isArmor=true;this.contentTemplate=Handlebars.compile($("#content-template").html());this.statsBoxTemplate=Handlebars.compile($("#stats-box-template").html())},calculateSetStats:function(e){var t=new I;for(var a=0;a<e.pieces.length;a++){var s=e.pieces[a];t.stats.physical_defense+=parseFloat(s.stats.physical_defense);t.stats.strike_defense+=parseFloat(s.stats.strike_defense);t.stats.slash_defense+=parseFloat(s.stats.slash_defense);t.stats.thrust_defense+=parseFloat(s.stats.thrust_defense);t.stats.fire_defense+=parseFloat(s.stats.fire_defense);t.stats.lightning_defense+=parseFloat(s.stats.lightning_defense);t.stats.magic_defense+=parseFloat(s.stats.magic_defense);t.stats.dark_defense+=parseFloat(s.stats.dark_defense);t.stats.bleed_resist+=parseFloat(s.stats.bleed_resist);t.stats.poison_resist+=parseFloat(s.stats.poison_resist);t.stats.curse_resist+=parseFloat(s.stats.curse_resist);t.stats.dark_resist+=parseFloat(s.stats.dark_resist);t.stats.weight+=parseFloat(s.stats.weight);t.stats.poise+=parseFloat(s.stats.poise);t.stats.durability+=parseInt(s.stats.durability);if(t.name===""){t.name=s.set}else if(s.set!==t.name){t.name="Custom Set"}t.type=s.type}return t},calculatePhysicalWeightRatio:function(e){var t;t=F.parseValue(e.stats.physical_defense);t+=F.parseValue(e.stats.strike_defense);t+=F.parseValue(e.stats.slash_defense);t+=F.parseValue(e.stats.thrust_defense);return t/4/F.parseValue(e.stats.weight)},calculateElementalWeightRatio:function(e){var t;t=F.parseValue(e.stats.fire_defense);t+=F.parseValue(e.stats.magic_defense);t+=F.parseValue(e.stats.lightning_defense);t+=F.parseValue(e.stats.dark_defense);return t/4/F.parseValue(e.stats.weight)},calculatePoiseWeightRatio:function(e){return F.parseValue(e.stats.poise)/F.parseValue(e.stats.weight)},renderSets:function(e,t){var a=F.renderImage(e,"type");var s=F.renderImage(t,"type");var r="";r+=this.renderPhysicalDefense(e,t);r+=this.renderElementalDefense(e,t);r+=this.renderResistances(e,t);r+=this.renderOthers(e,t);return this.contentTemplate({body:r,description1:a,description2:s})},renderPiece:function(e){var t="";var a=_.find(this.armor1.pieces,{piece:e});var s=_.find(this.armor2.pieces,{piece:e});if(a===undefined&&s===undefined){return""}else if(a===undefined&&s){a=new I(null,e)}else if(s===undefined&&a){s=new I(null,e)}var r=F.renderImage(a,"type");var i=F.renderImage(s,"type");var t="";t+=this.renderPhysicalDefense(a,s);t+=this.renderElementalDefense(a,s);t+=this.renderResistances(a,s);t+=this.renderOthers(a,s);return this.contentTemplate({body:t,description1:r,description2:i})},renderPhysicalDefense:function(e,t){
var a="",s=e.stats||{},r=t.stats||{};a+=F.renderAttribute("darksouls2/icon_physical_reduction","Physical",s.physical_defense,r.physical_defense);a+=F.renderAttribute("darksouls2/icon_strike_reduction","Strike",s.strike_defense,r.strike_defense);a+=F.renderAttribute("darksouls2/icon_slash_reduction","Slash",s.slash_defense,r.slash_defense);a+=F.renderAttribute("darksouls2/icon_thrust_reduction","Thrust",s.thrust_defense,r.thrust_defense);return this.statsBoxTemplate({title:"Physical Defense",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderElementalDefense:function(e,t){var a="",s=e.stats||{},r=t.stats||{};a+=F.renderAttribute("darksouls2/icon_fire_reduction","Fire",s.fire_defense,r.fire_defense);a+=F.renderAttribute("darksouls2/icon_magic_reduction","Magic",s.magic_defense,r.magic_defense);a+=F.renderAttribute("darksouls2/icon_lightning_reduction","Lightning",s.lightning_defense,r.lightning_defense);a+=F.renderAttribute("darksouls2/icon_dark_reduction","Dark",s.dark_defense,r.dark_defense);return this.statsBoxTemplate({title:"Elemental Defense",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderResistances:function(e,t){var a="",s=e.stats||{},r=t.stats||{};a+=F.renderAttribute("darksouls2/icon_bleed_reduction","Bleed",s.bleed_resist,r.bleed_resist);a+=F.renderAttribute("darksouls2/icon_poison_reduction","Poison",s.poison_resist,r.poison_resist);a+=F.renderAttribute("darksouls2/icon_curse_reduction","Curse",s.curse_resist,r.curse_resist);a+=F.renderAttribute("darksouls2/icon_petrify_reduction","Petrify",s.petrify_resist,r.petrify_resist);return this.statsBoxTemplate({title:"Resistances",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderReqParams:function(e,t){var a="",s=e.req_param||{},r=t.req_param||{};a+=F.renderAttribute("darksouls2/icon_strength","Strength",s.strength,r.strength);a+=F.renderAttribute("darksouls2/icon_dexterity","Dexterity",s.dexterity,r.dexterity);a+=F.renderAttribute("darksouls2/icon_intelligence","Intelligence",s.intelligence,r.intelligence);a+=F.renderAttribute("darksouls2/icon_faith","Faith",s.faith,r.faith);return this.statsBoxTemplate({title:"Req Param",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},renderOthers:function(e,t){var a="",s=e.stats||{},r=t.stats||{};a+=F.renderAttribute("darksouls2/icon_poise","Poise",s.poise,r.poise);a+=F.renderAttribute("darksouls2/icon_weight","Weight",s.weight,r.weight,{isNegative:true});a+=F.renderAttribute("darksouls2/icon_durability","Durability",s.durability,r.durability,{isInteger:true});return this.statsBoxTemplate({title:"Others",name1:e.name,name2:t.name,stats:a,isArmor:this.isArmor})},render:function(e,t){this.armor1=e;this.armor2=t;this.set1=this.calculateSetStats(this.armor1);this.set2=this.calculateSetStats(this.armor2);var a=this.renderSets(this.set1,this.set2);a+=this.renderPiece("Head");a+=this.renderPiece("Chest");a+=this.renderPiece("Hands");a+=this.renderPiece("Legs");this.$el.html(a)}});var I=function(e,t){this.stats={fire_defense:0,lightning_defense:0,magic_defense:0,dark_defense:0,physical_defense:0,strike_defense:0,slash_defense:0,thrust_defense:0,bleed_resist:0,poison_resist:0,curse_resist:0,petrify_resist:0,weight:0,poise:0,durability:0};this.req_param={strength:0,dexterity:0,intelligence:0,faith:0};this.physical_defense_bonus="-";this.name=e?e:t?"Naked "+t:"";this.type="N/A";if(t){this.piece=t.capitalize()}};I.constructor.prototype=I;E.prototype.renderSetsEvolution=function(e,t){var a=[{name:null,defenses:new Array(e[0].data.length),resistances:new Array(e[0].data.length)},{name:null,defenses:new Array(t[0].data.length),resistances:new Array(t[0].data.length)}];e.forEach(function(e){e.data.forEach(function(e){var t=0,s=0;var r=e.set.split("+")[0].trim();if(a[0].name&&a[0].name!==r&&a[0].name!=="Custom Set"){a[0].name="Custom Set"}else if(!a[0].name){a[0].name=r}t+=F.parseValue(e.stats.physical_defense);t+=F.parseValue(e.stats.slash_defense);t+=F.parseValue(e.stats.strike_defense);t+=F.parseValue(e.stats.thrust_defense);t+=F.parseValue(e.stats.fire_defense);t+=F.parseValue(e.stats.magic_defense);t+=F.parseValue(e.stats.lightning_defense);t+=F.parseValue(e.stats.dark_defense);s+=F.parseValue(e.stats.bleed_resist);s+=F.parseValue(e.stats.curse_resist);s+=F.parseValue(e.stats.poison_resist);s+=F.parseValue(e.stats.petrify_resist);if(!a[0].defenses[e.level])a[0].defenses[e.level]=0;if(!a[0].resistances[e.level])a[0].resistances[e.level]=0;a[0].defenses[e.level]+=t;a[0].resistances[e.level]+=s})});t.forEach(function(e){e.data.forEach(function(e){var t=0,s=0;var r=e.set.split("+")[0].trim();if(a[1].name&&a[1].name!==r&&a[1].name!=="Custom Set"){a[1].name="Custom Set"}else if(!a[1].name){a[1].name=r}t+=F.parseValue(e.stats.physical_defense);t+=F.parseValue(e.stats.slash_defense);t+=F.parseValue(e.stats.strike_defense);t+=F.parseValue(e.stats.thrust_defense);t+=F.parseValue(e.stats.fire_defense);t+=F.parseValue(e.stats.magic_defense);t+=F.parseValue(e.stats.lightning_defense);t+=F.parseValue(e.stats.dark_defense);s+=F.parseValue(e.stats.bleed_resist);s+=F.parseValue(e.stats.curse_resist);s+=F.parseValue(e.stats.poison_resist);s+=F.parseValue(e.stats.petrify_resist);if(!a[1].defenses[e.level])a[1].defenses[e.level]=0;if(!a[1].resistances[e.level])a[1].resistances[e.level]=0;a[1].defenses[e.level]+=t;a[1].resistances[e.level]+=s})});F.drawArmorEvolutions(a)};E.prototype.renderDefensesChart=function(e,t){var a=["Regular Def","Slash Def","Strike Def","Thrust Def","Fire Def","Magic Red","Lightning Red","Dark Res","Bleed Res","Poison Res","Curse Res","Petrify Res","Poise","Weight"];var s=[F.parseValue(e.stats.physical_defense),F.parseValue(e.stats.slash_defense),F.parseValue(e.stats.strike_defense),F.parseValue(e.stats.thrust_defense),F.parseValue(e.stats.fire_defense),F.parseValue(e.stats.magic_defense),F.parseValue(e.stats.lightning_defense),F.parseValue(e.stats.dark_defense),F.parseValue(e.stats.bleed_resist),F.parseValue(e.stats.poison_resist),F.parseValue(e.stats.curse_resist),F.parseValue(e.stats.petrify_resist),F.parseValue(e.stats.poise),F.parseValue(e.stats.weight)];var r=[F.parseValue(t.stats.physical_defense),F.parseValue(t.stats.slash_defense),F.parseValue(t.stats.strike_defense),F.parseValue(t.stats.thrust_defense),F.parseValue(t.stats.fire_defense),F.parseValue(t.stats.magic_defense),F.parseValue(t.stats.lightning_defense),F.parseValue(t.stats.dark_defense),F.parseValue(t.stats.bleed_resist),F.parseValue(t.stats.poison_resist),F.parseValue(t.stats.curse_resist),F.parseValue(t.stats.petrify_resist),F.parseValue(t.stats.poise),F.parseValue(t.stats.weight)];F.drawArmorDefenses(a,e.name,s,t.name,r)};var N=Backbone.View.extend({initialize:function(){this.isArmor=false;this.game="darksouls2";this.contentTemplate=Handlebars.compile($("#content-template").html());this.statsBoxTemplate=Handlebars.compile($("#stats-box-template").html())},calculateDamageWeightRatio:function(e){var t;t=F.parseValue(e.stats.physical_damage);t+=F.parseValue(e.stats.fire_damage);t+=F.parseValue(e.stats.magic_damage);t+=F.parseValue(e.stats.lightning_damage);t+=F.parseValue(e.stats.dark_damage);return t/4/F.parseValue(e.stats.weight)},calculateStabilityWeightRation:function(e){return F.parseValue(e.stats.stability)/F.parseValue(e.stats.weight)},renderDamageStats:function(e,t){var a="",s=e.stats,r=t.stats,i=this.calculateDamageWeightRatio(e),n=this.calculateDamageWeightRatio(t);a+=F.renderAttribute("darksouls2/icon_physical_damage","Physical",s.physical_damage,r.physical_damage);a+=F.renderAttribute("darksouls2/icon_magic_damage","Magic",s.magic_damage,r.magic_damage);a+=F.renderAttribute("darksouls2/icon_fire_damage","Fire",s.fire_damage,r.fire_damage);a+=F.renderAttribute("darksouls2/icon_lightning_damage","Lightning",s.lightning_damage,r.lightning_damage);a+=F.renderAttribute("darksouls2/icon_dark_damage","Dark",s.dark_damage,r.dark_damage);a+=F.renderAttribute("darksouls2/icon_physical_damage","Dmg/Wei",i.toFixed(2),n.toFixed(2),{tooltip:"Damage/Weight"});return this.statsBoxTemplate({title:"Damage",name1:e.name,name2:t.name,stats:a,game:this.game,isArmor:this.isArmor})},renderAuxDamageStats:function(e,t){var a="",s=e.stats,r=t.stats;a+=F.renderAttribute("darksouls2/icon_poison_damage","Poison",s.poison_damage,r.poison_damage);a+=F.renderAttribute("darksouls2/icon_bleed_damage","Bleed",s.bleed_damage,r.bleed_damage);a+=F.renderAttribute("darksouls2/icon_counter_damage","Counter",s.counter_damage,r.counter_damage);a+=F.renderAttribute("darksouls2/icon_poise_damage","Poise",s.poise_damage,r.poise_damage);return this.statsBoxTemplate({title:"Aux. Damage",name1:e.name,name2:t.name,stats:a,game:this.game,isArmor:this.isArmor})},renderReductionStats:function(e,t){var a="",s=e.stats,r=t.stats;a+=F.renderAttribute("darksouls2/icon_physical_reduction","Physical",s.physical_reduction,r.physical_reduction);a+=F.renderAttribute("darksouls2/icon_magic_reduction","Magic",s.magic_reduction,r.magic_reduction);a+=F.renderAttribute("darksouls2/icon_fire_reduction","Fire",s.fire_reduction,r.fire_reduction);a+=F.renderAttribute("darksouls2/icon_lightning_reduction","Lightning",s.lightning_reduction,r.lightning_reduction);a+=F.renderAttribute("darksouls2/icon_dark_reduction","Dark",s.dark_reduction,r.dark_reduction);return this.statsBoxTemplate({title:"Reduction",name1:e.name,name2:t.name,stats:a,game:this.game,isArmor:this.isArmor})},renderAuxReductionStats:function(e,t){var a="",s=e.stats,r=t.stats;a+=F.renderAttribute("darksouls2/icon_poison_reduction","Poison",s.poison_reduction,r.poison_reduction);a+=F.renderAttribute("darksouls2/icon_bleed_reduction","Bleed",s.bleed_reduction,r.bleed_reduction);a+=F.renderAttribute("darksouls2/icon_petrify_reduction","Petrify",s.petrify_reduction,r.petrify_reduction);a+=F.renderAttribute("darksouls2/icon_curse_reduction","Curse",s.curse_reduction,r.curse_reduction);return this.statsBoxTemplate({title:"Aux. Reduction",name1:e.name,name2:t.name,stats:a,game:this.game,isArmor:this.isArmor})},renderParamBonus:function(e,t){var a="",s=e.param_bonus,r=t.param_bonus;a+=F.renderAttribute("darksouls2/icon_strength_bonus","Strength",s.strength,r.strength,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls2/icon_dexterity_bonus","Dexterity",s.dexterity,r.dexterity,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls2/icon_magic_bonus","Magic",s.magic,r.magic,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls2/icon_fire_bonus","Fire",s.fire,r.fire,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls2/icon_lightning_bonus","Lightning",s.lightning,r.lightning,{isNegative:true,isString:true,invertSymbols:true});a+=F.renderAttribute("darksouls2/icon_dark_bonus","Dark",s.dark,r.dark,{isNegative:true,isString:true,invertSymbols:true});return this.statsBoxTemplate({title:"Param Bonus",name1:e.name,name2:t.name,stats:a,game:this.game,isArmor:this.isArmor})},renderReqParams:function(e,t){var a="",s=e.req_param,r=t.req_param;a+=F.renderAttribute("darksouls2/icon_strength","Strength",s.strength,r.strength,{isNegative:true,isInteger:true});a+=F.renderAttribute("darksouls2/icon_dexterity","Dexterity",s.dexterity,r.dexterity,{isNegative:true,isInteger:true});a+=F.renderAttribute("darksouls2/icon_intelligence","Intelligence",s.intelligence,r.intelligence,{isNegative:true,isInteger:true});a+=F.renderAttribute("darksouls2/icon_faith","Faith",s.faith,r.faith,{isNegative:true,isInteger:true});return this.statsBoxTemplate({title:"Req Params",name1:e.name,name2:t.name,stats:a,game:this.game,isArmor:this.isArmor})},renderOthers:function(e,t,a){var s="",r=this.calculateStabilityWeightRation(e),i=this.calculateStabilityWeightRation(t);s+=F.renderAttribute("darksouls2/icon_shot_range","Shot Range",e.stats.shot_range,t.stats.shot_range,{isNegative:true});s+=F.renderAttribute("darksouls2/icon_stability","Stability",e.stats.stability,t.stats.stability);s+=F.renderAttribute("darksouls2/icon_casting_speed","Casting Speed",e.stats.casting_speed,t.stats.casting_speed,{isNegative:true});s+=F.renderAttribute("darksouls2/icon_weight","Weight",e.stats.weight,t.stats.weight,{isNegative:true});s+=F.renderAttribute("darksouls2/icon_durability","Durability",e.stats.durability,t.stats.durability,{isInteger:true});s+=F.renderAttribute("darksouls2/icon_stability","Sta/Wei",r.toFixed(2),i.toFixed(2),{tooltip:"Stability/Weight"});return this.statsBoxTemplate({title:"Others",name1:e.name,name2:t.name,stats:s,game:this.game,isArmor:this.isArmor})},render:function(e,t,a){var s=F.renderImage(e,"attack_type","weapon_type");var r=F.renderImage(t,"attack_type","weapon_type");var i="";i+=this.renderDamageStats(e,t);i+=this.renderAuxDamageStats(e,t);i+=this.renderReductionStats(e,t);i+=this.renderParamBonus(e,t);i+=this.renderReqParams(e,t);i+=this.renderOthers(e,t,a);i+=F.renderChartBox("weapons-evolution","col-sm-12 col-md-12");i+=F.renderChartBox("shields-evolution","col-sm-6 col-md-6");i+=F.renderChartBox("shields-reduction","col-sm-6 col-md-6");content=this.contentTemplate({body:i,description1:s,description2:r});this.$el.html(content)}});N.prototype.renderWeaponsEvolution=function(e,t){var a=e.data.map(function(e){var t=0;t+=F.parseValue(e.stats.physical_damage);t+=F.parseValue(e.stats.magic_damage);t+=F.parseValue(e.stats.fire_damage);t+=F.parseValue(e.stats.lightning_damage);t+=F.parseValue(e.stats.dark_damage);return t});var s=t.data.map(function(e){var t=0;t+=F.parseValue(e.stats.physical_damage);t+=F.parseValue(e.stats.magic_damage);t+=F.parseValue(e.stats.fire_damage);t+=F.parseValue(e.stats.lightning_damage);t+=F.parseValue(e.stats.dark_damage);return t});F.drawWeaponEvolution(e.name,a,t.name,s)};N.prototype.renderShieldsEvolution=function(e,t){var a=e.data.map(function(e){return F.parseValue(e.stats.stability)});var s=t.data.map(function(e){return F.parseValue(e.stats.stability)});F.drawShieldEvolution(e.name,a,t.name,s)};N.prototype.renderReductionsChart=function(e,t){var a=["Physical Red","Fire Red","Magic Red","Lightning Red","Dark Red","Bleed Res","Poison Res","Curse Res","Petrify Res","Stability","Weight"];var s=[F.parseValue(e.stats.physical_reduction),F.parseValue(e.stats.magic_reduction),F.parseValue(e.stats.fire_reduction),F.parseValue(e.stats.lightning_reduction),F.parseValue(e.stats.dark_reduction),F.parseValue(e.stats.bleed_reduction),F.parseValue(e.stats.poison_reduction),F.parseValue(e.stats.curse_reduction),F.parseValue(e.stats.petrify_reduction),F.parseValue(e.stats.stability),F.parseValue(e.weight)];var r=[F.parseValue(t.stats.physical_reduction),F.parseValue(t.stats.magic_reduction),F.parseValue(t.stats.fire_reduction),F.parseValue(t.stats.lightning_reduction),F.parseValue(t.stats.dark_reduction),F.parseValue(t.stats.bleed_reduction),F.parseValue(t.stats.poison_reduction),F.parseValue(t.stats.curse_reduction),F.parseValue(t.stats.petrify_reduction),F.parseValue(t.stats.stability),F.parseValue(t.weight)];F.drawShieldsReductions(a,e.name,s,t.name,r)};